<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Week 3 - Working with data files | Week 3 - Working with data files</title>
<meta name="author" content="Dr Richard Clarke">
<meta name="description" content="6.1 Introduction The aim of this chapter is to reproduce the following figure from Bravo-Gutierrez et al (2021). The figure shows the percentage of methylation for two genes, AHRR (fig. 2a) and...">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content="Chapter 6 Week 3 - Working with data files | Week 3 - Working with data files">
<meta property="og:type" content="book">
<meta property="og:description" content="6.1 Introduction The aim of this chapter is to reproduce the following figure from Bravo-Gutierrez et al (2021). The figure shows the percentage of methylation for two genes, AHRR (fig. 2a) and...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Week 3 - Working with data files | Week 3 - Working with data files">
<meta name="twitter:description" content="6.1 Introduction The aim of this chapter is to reproduce the following figure from Bravo-Gutierrez et al (2021). The figure shows the percentage of methylation for two genes, AHRR (fig. 2a) and...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="www/webex.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Week 3 - Working with data files</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Index</a></li>
<li><a class="" href="welcome.html"><span class="header-section-number">2</span> Welcome</a></li>
<li><a class="" href="getting-started.html"><span class="header-section-number">3</span> Getting started</a></li>
<li><a class="" href="writing-and-running-your-first-code.html"><span class="header-section-number">4</span> Writing and running your first code</a></li>
<li><a class="" href="week-2---basic-visualisation.html"><span class="header-section-number">5</span> Week 2 - Basic visualisation</a></li>
<li><a class="active" href="week-3---working-with-data-files.html"><span class="header-section-number">6</span> Week 3 - Working with data files</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="week-3---working-with-data-files" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Week 3 - Working with data files<a class="anchor" aria-label="anchor" href="#week-3---working-with-data-files"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction-1" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-1"><i class="fas fa-link"></i></a>
</h2>
<p>The aim of this chapter is to reproduce the following figure from <a href="https://doi.org/10.3390/genes12081276">Bravo-Gutierrez et al (2021)</a>. The figure shows the percentage of methylation for two genes, AHRR (fig. 2a) and PRSS23 (fig. 2b), as compared across smokers and non-smokers. The genetics aspect might be confusing (at least to us psychologists) but the statistics are very basics (a Mann-Whitney U test). The authors found a significant difference across smokers AHRR gene (p=0.003) but not across the PRSS23 gene (p=0.276)</p>
<div class="inline-figure"><img src="Images/Bravo-Gutierrez%202021%20-%20Figure%202.png" width="100%" style="display: block; margin: auto;"></div>
<p>The authors of the paper have made the data from the study open access (as all good scientists should!), but not their code. Let's replicate the analysis and see if we can find the same results and can create the same image.</p>
<p>Download the data from the papers supplemental materials at the bottom of <a href="https://doi.org/10.3390/genes12081276">the paper</a> or if you have access to moodle I have uploaded the file to this weeks section.</p>
<p>For this chapter your will need the following packages. If needed, check previous chapters for how to install and load packages.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># tidy grammer and ggplot for the graphs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span> <span class="co"># tidys up and statistical findings</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span> <span class="co"># to add p values to graph</span></span></code></pre></div>
</div>
<div id="reading-data-into-r-from-a-data-file" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Reading data into R from a data file<a class="anchor" aria-label="anchor" href="#reading-data-into-r-from-a-data-file"><i class="fas fa-link"></i></a>
</h2>
<p>Data is often messy, this is especially true of data you don't collect yourself, and it's <em>especially especially</em> true for data that other academics share online. Data transparency is often an afterthought for a publication, with little care and attention given to if the data is usable, and mostly just shared in order to tick the box to say that its available.</p>
<p>Thankfully, the data shared for this paper is nice and neat and tidy, we only need to take a few steps to get it into R.</p>
<div id="setting-your-working-directory" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> Setting your working directory<a class="anchor" aria-label="anchor" href="#setting-your-working-directory"><i class="fas fa-link"></i></a>
</h3>
<p>Each time you start an analysis in R I recommend that you create a new folder. Put all the data you want to analyses in that folder. Open a script in R and save that script in your newly created folder along with your data.</p>
<div class="inline-figure"><img src="Images/Data%20in%20working%20directory.png" width="50%" style="display: block; margin: auto;"></div>
<p>Once everything is in the same place, back in RStudio, set your <strong>working directory</strong> by clicking <strong>Session</strong> <code>-&gt;</code> <strong>Set Working Directory</strong> <code>-&gt;</code> <strong>Choose Directory</strong> and then select your chosen folder.</p>
<p>This allows R to know where to look when you want to import data, and also where to save any outputs. It seems like a silly step when we're just making a couple of plots, but as your projects become more complicated this kind of workflow becomes invaluable.</p>
</div>
<div id="file-formats-and-reading-in-the-data" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> File formats and reading in the data<a class="anchor" aria-label="anchor" href="#file-formats-and-reading-in-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>Open the Excel file downloaded from the supplemental materials of Bravo-Gutierrez et al 2021. You should see four tabs at the bottom of the file, this means we're going to have to split this file up into individual pages to get it into RStudio. Excel files also comes with a whole load of hidden junk that that we don't want so instead we would like to save this tab out as a Comma-Separated Values (CSV) file, which is just a text file with a comma separating of the values in our data set.</p>
<p>Our data is on tab S4 and luckily it's in a lovely state and just requires us to <em>navigate to the S4 tab</em>, click <em>save as</em> and then <em>select CSV from the drop down "save as type" menu</em>. Save this to the folder you created previously.</p>
<div class="webex-solution">
<button>
The nightmare excel file
</button>
<p>Before continuing, take a quick look at the other tabs in the file. Tab one looks intimidating but this is just two screen shots from an online gene database. It's tabs S2 and S3 that scare me (or at least it would take me a while to get them into a usable form). If you scroll down on either of these tabs you'll see that the headers repeat themselves and the data is not all neatly in a line as you would find in an SPSS file. Carry on further with R and you'll learn how to work with this, and other even messier, kind of data, and turn it into whats known as <a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">tidy data</a>.</p>
</div>
</div>
<div id="reading-data-in-to-r" class="section level3" number="6.2.3">
<h3>
<span class="header-section-number">6.2.3</span> Reading data in to R<a class="anchor" aria-label="anchor" href="#reading-data-in-to-r"><i class="fas fa-link"></i></a>
</h3>
<p>So long as you have set your working directory and your have loaded the <code>tidyverse</code> package the following code, adapted for your file name, will read the data in and assign it to an object.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Bravo-Gutierrez figure 2 data.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="webex-solution">
<button>
Why use read_csv rather than read.csv
</button>
<p>While the <code>read.csv</code> is from base R, the <code>read_csv</code> function is found in the <code>readr</code> package from the <code>tidyverse</code> so there's and extra step to get the function but its worth it for three reasons:</p>
<ol style="list-style-type: decimal">
<li>
<code>read_csv</code> does not convert character strings into factors by default, unlike read.csv.</li>
<li>
<code>read_csv</code> returns tibbles rather than data frames. Basically, the same but tibbles work better with the other <code>tidyverse</code> packages</li>
<li>
<code>read_csv</code> something to do with NAs.</li>
</ol>
<p>Is this the dullest note topic in the whole book? Maybe, its a good contender at least.</p>
</div>
</div>
<div id="self-test" class="section level3" number="6.2.4">
<h3>
<span class="header-section-number">6.2.4</span> Self test<a class="anchor" aria-label="anchor" href="#self-test"><i class="fas fa-link"></i></a>
</h3>
<p>What does the working directory do? <select class="webex-select"><option value="blank"></option>
<option value="answer">It is the location on your computer where RStudio runs and accesses your files</option>
<option value="">It give you extra RAM to your analysis quicker</option>
<option value="">It changes the colour theme of RStudio</option></select></p>
<p>What is a CSV file? <select class="webex-select"><option value="blank"></option>
<option value="">A file specially made for use in R</option>
<option value="answer">A general use text file storing tabular data, separated by commas</option>
<option value="">A file for storing supplementary figure for a paper</option></select></p>
<p>What would you type to read the following data and assign it to a object <code>data</code>?</p>
<p>Can you read an SPSS file into R? <select class="webex-select"><option value="blank"></option>
<option value="">That program is dead to us now. Never speak those letter again!</option>
<option value="answer">Yes, check out the Haven package for more on this topic</option></select></p>
</div>
</div>
<div id="step-2-data-wrangling" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Step 2: Data wrangling<a class="anchor" aria-label="anchor" href="#step-2-data-wrangling"><i class="fas fa-link"></i></a>
</h2>
<p>We are yet to wrangle. Well, I wrangled a little in the last chapter but didn't really explain</p>
<p>We only actually need three variables from this dataset so the first thing we are going to do to tidy this data set up is to pull out those variables and put them in a new object called <code>fig2_data</code>.</p>
<p>Use the <code>select</code> function (as mentioned in week 1) to take the variables <code>Sample_ID</code>, <code>%5mc-AHRR</code> &amp; <code>%5mc-PRSS23</code> and create a new object called <code>fig2_data</code></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op">&lt;-</span> <span class="va">raw_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="va">`%5mc-AHRR`</span>,<span class="va">`%5mc-PRSS23`</span><span class="op">)</span></span></code></pre></div>
<p>If you look at the <code>Sample_ID</code> variable, you'll see that the variable indicates if the participant is a non-smoker (NS) or smoker (S) and it includes their ID number. In order to recreate the analysis we need to create a new variable that just contains the smoker or non-smoker data.</p>
<p>There are a number of ways to do this, but here is what I did:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op">&lt;-</span> <span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>smoker <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html">str_starts</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="st">"NS"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Non-Smoker"</span>,</span>
<span>                            <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html">str_starts</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="st">"S"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Smoker"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>The first line tells R to just overwrite the same data object with whatever we do next. I then used the <code>mutate</code> function to create a new variable. This variable will be called <code>smoker</code> and I've told R to look at the start of each string of data in the variable <code>Sample_ID</code> and if the letters "NS" are first then put "Non-Smoker" in the new variable, and if the letter "S" if first then put "Smoker" in the new variable.</p>
<p>If you were to <code>View(fig2_data)</code> now you will see a new variables has been created with our smoker/non-smoker information.</p>
<p>Lets also change the names on our gene variables while we're at it:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op">&lt;-</span> <span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>AHRR <span class="op">=</span> <span class="va">`%5mc-AHRR`</span>,</span>
<span>         PRSS23 <span class="op">=</span> <span class="va">`%5mc-PRSS23`</span><span class="op">)</span></span></code></pre></div>
<div class="webex-solution">
<button>
Note about variable names
</button>
<p>Variable names need to be in a specific format for R to recognise them as such. Our original data starts with a % sign which confuses R. To get around this issue it encloses the name in `` punctuation, as a way to indicate that this is a string. More commonly you'll see this when your variable name have a SPACE between words. It's worth recording these when you see them as they can be a bit of a pain when it comes to using auto-complete in your analysis later on.</p>
</div>
</div>
<div id="step-3-discriptive-statistics-and-basic-visulisation" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Step 3: Discriptive statistics and basic visulisation<a class="anchor" aria-label="anchor" href="#step-3-discriptive-statistics-and-basic-visulisation"><i class="fas fa-link"></i></a>
</h2>
<p>Now we'll run some basic summary statistics to get a feel of the data.</p>
<p>Create a new dataframe called <code>fig2_discriptives</code> out of the <code>fig2_data</code> object. This dataframe needs to contain the number of partcipants and the mean, median, and standard deviation of AHRR methylation split by smokers and non-smokers.</p>
<p>For this you will need to use the <code>group_by</code> and <code>summarise</code> functions as mentioned in week 2. There is also some missing data so you will also need to include the following code at various points <code>na.rm = TRUE</code></p>
<div class="webex-solution">
<button>
Click for solution
</button>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_discriptives</span> <span class="op">&lt;-</span> <span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">smoker</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">AHRR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">AHRR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">AHRR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Next use <code>ggplot</code> to create a basic box plot of the <code>AHRR</code> methylation variable as separated by our <code>smoker</code> independent variable.</p>
<div class="webex-solution">
<button>
Click for solution
</button>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">smoker</span>, y<span class="op">=</span><span class="va">AHRR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-64-1.png" width="672"></div>
</div>
</div>
<div id="step-4-statistical-test" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Step 4: Statistical test<a class="anchor" aria-label="anchor" href="#step-4-statistical-test"><i class="fas fa-link"></i></a>
</h2>
<p>Now for the statistical test</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">AHRR</span> <span class="op">~</span> <span class="va">smoker</span>, data<span class="op">=</span><span class="va">fig2_data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p.value</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>cg05575921</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_comparisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Smoker"</span>, <span class="st">"Non-Smoker"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">smoker</span>, y<span class="op">=</span><span class="va">AHRR</span>, fill<span class="op">=</span><span class="va">smoker</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means</a></span><span class="op">(</span>comparisons <span class="op">=</span> <span class="va">my_comparisons</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"%5mc-cg05575921"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-66-1.png" width="672"></div>
</div>
<div id="test-yourself-exercise" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Test yourself exercise<a class="anchor" aria-label="anchor" href="#test-yourself-exercise"><i class="fas fa-link"></i></a>
</h2>
<p>Create a new script and create the following for the PRSS23 gene</p>
<ul>
<li>A dataframe containing the summary statistics</li>
<li>A dataframe containing the comparison analysis</li>
<li>Figure 2b from the original paper.</li>
</ul>
<p>Note to create Figure 2b you will need this additional line of code that will re-scale the y-axis:
<code>scale_y_continuous(limits=c(0, 10), name = "PRSS23")</code></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># reveal for answer</span></span>
<span><span class="va">fig2_discriptives</span> <span class="op">&lt;-</span> <span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">smoker</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">PRSS23</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">PRSS23</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">PRSS23</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">smoker</span>, y<span class="op">=</span><span class="va">PRSS23</span>, fill<span class="op">=</span><span class="va">smoker</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means</a></span><span class="op">(</span>comparisons <span class="op">=</span> <span class="va">my_comparisons</span>, label.y <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"PRSS23"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># limits added to make it look like the paper </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-67-1.png" width="672"></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># more work needed to add the p values</span></span></code></pre></div>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><div class="chapter-nav">
<div class="prev"><a href="week-2---basic-visualisation.html"><span class="header-section-number">5</span> Week 2 - Basic visualisation</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#week-3---working-with-data-files"><span class="header-section-number">6</span> Week 3 - Working with data files</a></li>
<li><a class="nav-link" href="#introduction-1"><span class="header-section-number">6.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#reading-data-into-r-from-a-data-file"><span class="header-section-number">6.2</span> Reading data into R from a data file</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#setting-your-working-directory"><span class="header-section-number">6.2.1</span> Setting your working directory</a></li>
<li><a class="nav-link" href="#file-formats-and-reading-in-the-data"><span class="header-section-number">6.2.2</span> File formats and reading in the data</a></li>
<li><a class="nav-link" href="#reading-data-in-to-r"><span class="header-section-number">6.2.3</span> Reading data in to R</a></li>
<li><a class="nav-link" href="#self-test"><span class="header-section-number">6.2.4</span> Self test</a></li>
</ul>
</li>
<li><a class="nav-link" href="#step-2-data-wrangling"><span class="header-section-number">6.3</span> Step 2: Data wrangling</a></li>
<li><a class="nav-link" href="#step-3-discriptive-statistics-and-basic-visulisation"><span class="header-section-number">6.4</span> Step 3: Discriptive statistics and basic visulisation</a></li>
<li><a class="nav-link" href="#step-4-statistical-test"><span class="header-section-number">6.5</span> Step 4: Statistical test</a></li>
<li><a class="nav-link" href="#test-yourself-exercise"><span class="header-section-number">6.6</span> Test yourself exercise</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Week 3 - Working with data files</strong>" was written by Dr Richard Clarke. It was last built on 2023-07-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
