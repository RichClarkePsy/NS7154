<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Week 3 - Working with data files | NS7154 R Workbook</title>
<meta name="author" content="Dr Richard Clarke">
<meta name="description" content="6.1 Introduction Our aim this week is to reproduce the figure below from Bravo-Gutierrez et al (2021). The figure shows the percentage of methylation for two genes, AHRR (fig. 2a) and PRSS23 (fig....">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content="Chapter 6 Week 3 - Working with data files | NS7154 R Workbook">
<meta property="og:type" content="book">
<meta property="og:description" content="6.1 Introduction Our aim this week is to reproduce the figure below from Bravo-Gutierrez et al (2021). The figure shows the percentage of methylation for two genes, AHRR (fig. 2a) and PRSS23 (fig....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Week 3 - Working with data files | NS7154 R Workbook">
<meta name="twitter:description" content="6.1 Introduction Our aim this week is to reproduce the figure below from Bravo-Gutierrez et al (2021). The figure shows the percentage of methylation for two genes, AHRR (fig. 2a) and PRSS23 (fig....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="www/webex.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">NS7154 R Workbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome</a></li>
<li><a class="" href="week-1---why-learn-r.html"><span class="header-section-number">2</span> Week 1 - Why learn R?</a></li>
<li><a class="" href="week-1---getting-started.html"><span class="header-section-number">3</span> Week 1 - Getting started</a></li>
<li><a class="" href="week-1---writing-and-running-your-first-code.html"><span class="header-section-number">4</span> Week 1 - Writing and running your first code</a></li>
<li><a class="" href="week-2---basic-visualisation.html"><span class="header-section-number">5</span> Week 2 - Basic visualisation</a></li>
<li><a class="active" href="week-3---working-with-data-files.html"><span class="header-section-number">6</span> Week 3 - Working with data files</a></li>
<li><a class="" href="week-4---working-with-catagorical-variables.html"><span class="header-section-number">7</span> Week 4 - Working with catagorical variables</a></li>
<li><a class="" href="week-5---simple-linear-regression.html"><span class="header-section-number">8</span> Week 5 - Simple Linear Regression</a></li>
<li><a class="" href="week-6---catch-up-week.html"><span class="header-section-number">9</span> Week 6 - Catch up week</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="week-3---working-with-data-files" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Week 3 - Working with data files<a class="anchor" aria-label="anchor" href="#week-3---working-with-data-files"><i class="fas fa-link"></i></a>
</h1>
<div id="introduction-1" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-1"><i class="fas fa-link"></i></a>
</h2>
<p>Our aim this week is to reproduce the figure below from <a href="https://doi.org/10.3390/genes12081276">Bravo-Gutierrez et al (2021)</a>. The figure shows the percentage of methylation for two genes, AHRR (fig. 2a) and PRSS23 (fig. 2b), as compared across smokers and non-smokers. The genetics aspect might be confusing (at least to us psychologists) but the statistics are very basics (a Mann-Whitney U test). The authors found a significant difference across methylation on the AHRR gene between smokers and non-smokers (p=0.003), with significantly lower levels of methylation for the smokers (indicating the suggested hypomethylation effect of smoking on the AHRR gene), but no significant difference in methylation across the PRSS23 gene (p=0.276).</p>
<div class="inline-figure"><img src="Images/Bravo-Gutierrez%202021%20-%20Figure%202.png" width="100%" style="display: block; margin: auto;"></div>
<p>The authors of the paper have made the data from the study open access (as all good scientists should!), but not their code. Let's replicate the analysis and see if we can find the same findings and create the same image.</p>
<p>Download the data from the supplemental materials at the bottom of <a href="https://doi.org/10.3390/genes12081276">the paper</a> or from this weeks section in the NS7154 Moodle area.</p>
<p>For this week your will need the following packages. If needed, check previous weeks for how to install and load packages.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span> <span class="co"># to add p-values to our graphs</span></span></code></pre></div>
</div>
<div id="reading-data-into-r-from-a-data-file" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Reading data into R from a data file<a class="anchor" aria-label="anchor" href="#reading-data-into-r-from-a-data-file"><i class="fas fa-link"></i></a>
</h2>
<p>Data is often messy, this is especially true of data you don't collect yourself, and it's <em>especially especially</em> true for data that other academics share online. Thankfully, the data shared for this paper is nice and neat and tidy, we only need to take a few steps to get it into R.</p>
<div id="setting-your-working-directory" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> Setting your working directory<a class="anchor" aria-label="anchor" href="#setting-your-working-directory"><i class="fas fa-link"></i></a>
</h3>
<p>Each time you start an analysis in R I recommend that you create a new folder. Put all the data you want to analyses in that folder. Open a script and save that script in your newly created folder along with your data.</p>
<div class="inline-figure"><img src="Images/Data%20in%20working%20directory.png" width="50%" style="display: block; margin: auto;"></div>
<p>Once everything is in the same place, back in RStudio, set your <strong>working directory</strong> by clicking <strong>Session</strong> <code>-&gt;</code> <strong>Set Working Directory</strong> <code>-&gt;</code> <strong>Choose Directory</strong> or <strong>To Source File Location</strong> and then select your chosen folder.</p>
<p>This allows R to know where to look when you want to import data, and also where to save any outputs. It may seem like a redundant step when we're just making a couple of plots, but as your projects become more complicated this kind of workflow becomes invaluable.</p>
</div>
<div id="file-formats-and-reading-in-the-data" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> File formats and reading in the data<a class="anchor" aria-label="anchor" href="#file-formats-and-reading-in-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>In Excel, open the file downloaded from the supplemental materials of Bravo-Gutierrez et al 2021. You should see four tabs at the bottom of the Excel window. While it is possible to directly read Excel files into RStudio, for the sake of simplicity, we're going to convert the specific tab we're interested into a Comma-Separated Values (CSV) file. A CSV file is simply a text file where the values in our dataset are separated by commas.</p>
<p>Our data is on tab S4 and luckily it's in a lovely state and just requires us to <strong>navigate to the S4 tab</strong>, click <strong>save as</strong> and then <strong>select</strong> <strong><em>CSV</em></strong> <strong>from the drop down "save as type" menu</strong>. Save this to the folder you created previously.</p>
<div class="webex-solution">
<button>
The nightmare excel file
</button>
<p>Before continuing, take a quick look at the other tabs in the file. Tab one looks intimidating, but this is just two screen shots from an online gene database. It's tabs S2 and S3 that scare me (or at least it would take me a while to get them into a usable form). If you scroll down on either of these tabs you'll see that the headers repeat themselves and the data is not all neatly in a line as you would find in an SPSS file. Carry on further with R and you'll learn how to work with this, and other even messier, kind of data, and convert them into what is known as <a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">tidy data</a>.</p>
</div>
</div>
<div id="reading-data-into-rstudio" class="section level3" number="6.2.3">
<h3>
<span class="header-section-number">6.2.3</span> Reading data into RStudio<a class="anchor" aria-label="anchor" href="#reading-data-into-rstudio"><i class="fas fa-link"></i></a>
</h3>
<p>So long as you have set your working directory (and you have loaded the <code>tidyverse</code> package) the following code, <strong>adapted for your file name</strong>, will read the data into RStudio and assign it to an object.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Bravo-Gutierrez figure 2 data.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="webex-solution">
<button>
Why use read_csv rather than read.csv
</button>
<p>If you're typing the code and paying attention to the autocompleate you may have noticed <code>read.csv</code> as an additional option. The <code>read.csv</code> function comes from base R, while <code>read_csv</code> is from the <code>readr</code> package, part of the <code>tidyverse</code>. While it requires an extra step to install and load <code>read_csv</code> its worth it for three reasons:</p>
<ol style="list-style-type: decimal">
<li>Unlike <code>read.csv</code>, <code>read_csv</code> does not convert character strings into factors by default. This gives you more control over how your data is read and interpreted.</li>
<li>
<code>read_csv</code> returns tibbles rather than traditional data frames. While they may seem identical, tibbles have several advantages that make them work better with the rest of the <code>tidyverse</code> packages. For instance, tibbles retain the data type of each column, do not convert character vectors to factors by default, and have improved printing methods.</li>
<li>
<code>read_csv</code> handles missing values (NAs) in a more straightforward manner and makes data cleaning and manipulation processes easier.</li>
</ol>
<p>Is this the dullest note in the whole book? Maybe, I at least feel it's a strong contender.</p>
</div>
</div>
<div id="test-yourself" class="section level3" number="6.2.4">
<h3>
<span class="header-section-number">6.2.4</span> Test yourself<a class="anchor" aria-label="anchor" href="#test-yourself"><i class="fas fa-link"></i></a>
</h3>
<p>What does the working directory do? <select class="webex-select"><option value="blank"></option>
<option value="answer">It is the location on your computer where RStudio runs and accesses your files</option>
<option value="">It gives you extra RAM to analyse your data more quickly</option>
<option value="">It changes the colour theme of RStudio</option></select></p>
<p>What is a CSV file? <select class="webex-select"><option value="blank"></option>
<option value="">A file specially made for use in R</option>
<option value="answer">A general use text file storing tabular data, separated by commas</option>
<option value="">A file for storing supplementary figure for a paper</option></select></p>
<p>If you were to run the above code, what would you then type to <code>view</code> this data file in a window? <input class="webex-solveme nospaces" size="14" data-answer='["View(raw_data)","view(raw_data)"]'></p>
<p>Can you read an SPSS file into R? <select class="webex-select"><option value="blank"></option>
<option value="">That program is dead to us now. Never speak those letter again!</option>
<option value="answer">Yes, check out the Haven package for more on this topic</option></select></p>
</div>
</div>
<div id="data-wrangling" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Data wrangling<a class="anchor" aria-label="anchor" href="#data-wrangling"><i class="fas fa-link"></i></a>
</h2>
<p>Data wrangling refers to the process of cleaning, structuring, and enriching raw data into a more suitable format for analysis. The <code>dplyr</code> package (again contained in the <code>tidyverse</code>) is particularly useful for this as it contains a range of six functions known as <strong>the Wickham Six</strong>.<br>
The Wickham Six:</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter()</a></code> - A function used to select rows in a dataset based on their values.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> - A function used to choose specific columns in a dataset, potentially dropping others.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> - A function used to create new columns in your dataset that are functions of existing columns (i.e. computing a latent variable out of individual questionnaire items).</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange()</a></code> - A function used to reorder rows in a dataset based on the values in one or several columns.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> - A function used to generate summay statistics of different columns in your dataset.</li>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> - A function, often used with <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>, to group the data by certain criteria before generating summary statistics.</li>
</ul>
<p>These functions are powerful and provide the building blocks for data wrangling in R. By chaining these functions together using the pipes (<code>%&gt;%</code>), we can perform complex data manipulations in a clean, readable, and efficient manner.</p>
<p>This week we'll be using <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>, and we'll be using them a lot throughout this module so you may want to note them down on a sticky note and attach them to the screen. That's what I did when I was first learning.</p>
<div id="selecting-variables-for-our-analysis" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> "Selecting" variables for our analysis<a class="anchor" aria-label="anchor" href="#selecting-variables-for-our-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>Looking back at the figure and its description in the paper we only actually need three variables from our dataset to create the boxplots. So, the first thing we'll do is tidy up the dataset by pulling out those variables and putting them in a new object called <code>fig2_data</code>.</p>
<p>The code below uses the <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> function, take the variables <code>Sample_ID</code>, <code>%5mc-AHRR</code> &amp; <code>%5mc-PRSS23</code> from our raw data and assigns them a new object called <code>fig2_data</code>.</p>
<p>Variable names can be a bit fiddly at times. Typically they should start with a letter and be free of spaces. Often, when importing from other sources, this rule is not adhered to. To cope with this R assigns such variable flanked by back-ticks as can be seen with our <code>%5mc-AHRR</code> and <code>%5mc-PRSS23</code> in the code below.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op">&lt;-</span> <span class="va">raw_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="va">`%5mc-AHRR`</span>,<span class="va">`%5mc-PRSS23`</span><span class="op">)</span></span></code></pre></div>
<p>Now <code><a href="https://tibble.tidyverse.org/reference/view.html">view()</a></code> the data to check that you have each of the variables mentioned. You could also check by using the <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> function</p>
<div class="webex-solution">
<button>
Note on e numbers
</button>
<p>You may have noticed the <code>[number]e+/-n</code> notation in the data. In this context, the <code>e</code> notation, also known as scientific notation, is used to represent numbers that are too large or too small to be conveniently written in decimal form. If any data in an R variable is exceptionally large or small (in our case, small), the entire variable is displayed in this scientific notation. While it may initially seem confusing, it's quite simple - for instance, <code>1.000000e+2</code> just means the number 100. Consider it a fun little quirk of R that you'll get accustomed to over time.</p>
</div>
<p>Have a play around with the code above and see if you can select out other variables and assign them to a different data object. This skill will be super helpful for your assignment, as it will allow you to just work on your variables of interest, instead of hacking your way through a 2000 variable file each time you want to run an analysis.</p>
</div>
<div id="mutating-the-sample-id-variable" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> "Mutating" the Sample ID variable<a class="anchor" aria-label="anchor" href="#mutating-the-sample-id-variable"><i class="fas fa-link"></i></a>
</h3>
<p>If you look at the <code>Sample_ID</code> variable in our dataset, you'll see that this variable is the variable that indicates if the participant is a non-smoker (NS) or smoker (S), however, it also lumps that information next to the participant ID number, not ideal.</p>
<p>In the bad-old-days I would have likely gone through each of these by hand, converting the ID variable into a grouping variable. This wouldn't have been <em>too</em> much of an issue for this particular dataset, but just imagine doing this for a dataset with thousands of participants! Luckily, we can do this conversion with a line of code using the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> function.</p>
<p>There are a number of ways to do this, but here is the way I did it for this example:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op">&lt;-</span> <span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>quasi_condition <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html">str_starts</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="st">"NS"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Non-Smoker"</span>,</span>
<span>                                     <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html">str_starts</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="st">"S"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Smoker"</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>The first line tells R to just overwrite the same data object with whatever we do next. I then use the <code>mutate</code> function to create a new variable. This variable will be called <code>quasi_condition</code> (as our independent variable here is quasi-experimental) and I've told R to look at the start of each string of data in the variable <code>Sample_ID</code> and if the letters "NS" are first then write "Non-Smoker" to the new variable, and if the letter "S" is first then write "Smoker" to the new variable.</p>
<div class="webex-solution">
<button>
Overwriting data
</button>
<p>This: <code>fig2_data &lt;- fig2_data</code> was risky. It's the kind of thing that can really mess up your code, especially if you overwrite your raw data. I've seen disasters in SPSS where students kept only a single save file and reverse-coded a variable, only to return to that file at a later date. Forgetting that they had already reverse-coded, they would inadvertently reverse it again. Although there is less chance of that here, thanks to our coding script, we should still be careful in more complicated projects. Data manipulation can become confusing and can potentially lead to unintended consequences.</p>
</div>
<p>Let's clean up the variable names, using the <code>rename</code> function while we're at it.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op">&lt;-</span> <span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>AHRR <span class="op">=</span> <span class="va">`%5mc-AHRR`</span>,</span>
<span>         PRSS23 <span class="op">=</span> <span class="va">`%5mc-PRSS23`</span><span class="op">)</span></span></code></pre></div>
<p>The further you progress in R the more you'll want/need your code to be neat and tidy. Here's the code that does all of the above in a single expression thanks to more piping (<code>%&gt;%</code>):</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op">&lt;-</span> <span class="va">raw_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="va">`%5mc-AHRR`</span>,<span class="va">`%5mc-PRSS23`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>quasi_condition <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html">str_starts</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="st">"NS"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Non-Smoker"</span>,</span>
<span>                                     <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html">str_starts</a></span><span class="op">(</span><span class="va">Sample_ID</span>, <span class="st">"S"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Smoker"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>AHRR <span class="op">=</span> <span class="va">`%5mc-AHRR`</span>,</span>
<span>         PRSS23 <span class="op">=</span> <span class="va">`%5mc-PRSS23`</span><span class="op">)</span></span></code></pre></div>
<p>If you were to <code>view(fig2_data)</code> now you will see a new variables has been created with our smoker/non-smoker information and the variable names are easier to handle.</p>
</div>
<div id="grouping-and-summarising-the-data" class="section level3" number="6.3.3">
<h3>
<span class="header-section-number">6.3.3</span> "Grouping" and "Summarising" the data<a class="anchor" aria-label="anchor" href="#grouping-and-summarising-the-data"><i class="fas fa-link"></i></a>
</h3>
<p>The code below takes the <code>fig2_data</code> object, groups it by our new condition variable, then uses the <code>summarise</code> function (not to be confused with the <code>summary</code> function) to give us the number of participants and the mean, median, and standard deviation of just the AHRR variable split by smokers and non-smokers.</p>
<p>There is also some missing data so I've added <code>na.rm = TRUE</code> to each of the arguments. We'll come back to how to deal with missing data again in a later weeks.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">quasi_condition</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">AHRR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">AHRR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">AHRR</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">quasi_condition</th>
<th align="right">N</th>
<th align="right">Mean</th>
<th align="right">Median</th>
<th align="right">SD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Non-Smoker</td>
<td align="right">114</td>
<td align="right">69.40041</td>
<td align="right">100.00000</td>
<td align="right">40.51247</td>
</tr>
<tr class="even">
<td align="left">Smoker</td>
<td align="right">102</td>
<td align="right">51.82911</td>
<td align="right">47.16221</td>
<td align="right">42.82668</td>
</tr>
</tbody>
</table></div>
</div>
<p>If you take a look at the output in your console, you can see how it compares to the figure from the original paper (see top of page). Boxplots have a thick black line for median of the data so for smokers a medium of 47 and for non-smokers a medium of 100 looks good to me.</p>
</div>
<div id="recreating-the-figure" class="section level3" number="6.3.4">
<h3>
<span class="header-section-number">6.3.4</span> Recreating the figure<a class="anchor" aria-label="anchor" href="#recreating-the-figure"><i class="fas fa-link"></i></a>
</h3>
<p>Next we can pipe our data into <code>ggplot</code> to create a basic boxplot of the <code>AHRR</code> methylation variable as separated by our <code>quasi_condition</code> independent variable.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">quasi_condition</span>, y<span class="op">=</span><span class="va">AHRR</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-67-1.png" width="672"></div>
<p>And then to turn it into the final figure all we need to do is the following:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_comparisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Smoker"</span>, <span class="st">"Non-Smoker"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">quasi_condition</span>, y<span class="op">=</span><span class="va">AHRR</span>, fill<span class="op">=</span><span class="va">quasi_condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means</a></span><span class="op">(</span>comparisons <span class="op">=</span> <span class="va">my_comparisons</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"%5mc-cg05575921"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-68-1.png" width="672"></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## List of 1
##  $ legend.position: chr "none"
##  - attr(*, "class")= chr [1:2] "theme" "gg"
##  - attr(*, "complete")= logi FALSE
##  - attr(*, "validate")= logi TRUE</code></pre>
<div class="webex-solution">
<button>
What coding can somtimes feel like
</button>
<p>Sorry, that one probably felt a little like this:</p>
<div class="inline-figure"><img src="Images/draw%20an%20owl.png" width="75%" style="display: block; margin: auto;"></div>
<p>However, this is why it's amazing we now have ChatGPT. Click <a href="https://chat.openai.com/share/75ffbf8e-fd4d-4090-bcbc-4b3e7a8c7661">this link</a> to see how great the AI is at explaining code.</p>
</div>
</div>
</div>
<div id="test-yourself-exercise" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Test yourself exercise<a class="anchor" aria-label="anchor" href="#test-yourself-exercise"><i class="fas fa-link"></i></a>
</h2>
<p>Create a new script and see if you can follow the wrangling steps again, this time to create:</p>
<ul>
<li>A dataframe containing the summary statistics for the PRSS23 gene</li>
<li>A boxplot as close to Figure 2b from the original paper as you can.</li>
</ul>
<p>Note: to match it exactly you'll need to add this additional line of code that will re-scale the y-axis:
<code>scale_y_continuous(limits=c(0, 10), name = "PRSS23")</code></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2b_discriptives</span> <span class="op">&lt;-</span> <span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">quasi_condition</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">PRSS23</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">PRSS23</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>            SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">PRSS23</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_comparisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Smoker"</span>, <span class="st">"Non-Smoker"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">quasi_condition</span>, y<span class="op">=</span><span class="va">PRSS23</span>, fill<span class="op">=</span><span class="va">quasi_condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means</a></span><span class="op">(</span>comparisons <span class="op">=</span> <span class="va">my_comparisons</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-70-1.png" width="672"></div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#or</span></span>
<span></span>
<span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">quasi_condition</span>, y<span class="op">=</span><span class="va">PRSS23</span>, fill<span class="op">=</span><span class="va">quasi_condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette<span class="op">=</span><span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means</a></span><span class="op">(</span>comparisons <span class="op">=</span> <span class="va">my_comparisons</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"PRSS23"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-70-2.png" width="672"></div>
<p>Yes, I too am annoyed about the missing p-value when you adjust the y-axis.</p>
<p>I think they calculated their p-values separately and then added them as a text geom. that would explain the slightly different p-value roundings.</p>
</div>
<p>Next tidy up the figure by
1. Adding a title.
2. Removing the label <code>quasi_conditions</code>.
3. Changing the colour scheme.
4. Changing the amount of jutter.</p>
<div class="webex-solution">
<button>
Hint
</button>
<p>Check back at the code from last week.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig2_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">quasi_condition</span>, y<span class="op">=</span><span class="va">PRSS23</span>, fill<span class="op">=</span><span class="va">quasi_condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_compare_means.html">stat_compare_means</a></span><span class="op">(</span>comparisons <span class="op">=</span> <span class="va">my_comparisons</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Figure 2. Methylation percentage between smokers and non-smokers."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"PRSS23"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-71-1.png" width="672"></div>
</div>
<hr>
<hr>
<p>This book is a work in progress. If you have any feedback or spot any mistakes please enter them into <a href="https://glos.onlinesurveys.ac.uk/r-codebook-feedback">this feedback survey</a> quoting the week your comment is referring to. Thank you! :-)</p>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><div class="chapter-nav">
<div class="prev"><a href="week-2---basic-visualisation.html"><span class="header-section-number">5</span> Week 2 - Basic visualisation</a></div>
<div class="next"><a href="week-4---working-with-catagorical-variables.html"><span class="header-section-number">7</span> Week 4 - Working with catagorical variables</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#week-3---working-with-data-files"><span class="header-section-number">6</span> Week 3 - Working with data files</a></li>
<li><a class="nav-link" href="#introduction-1"><span class="header-section-number">6.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#reading-data-into-r-from-a-data-file"><span class="header-section-number">6.2</span> Reading data into R from a data file</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#setting-your-working-directory"><span class="header-section-number">6.2.1</span> Setting your working directory</a></li>
<li><a class="nav-link" href="#file-formats-and-reading-in-the-data"><span class="header-section-number">6.2.2</span> File formats and reading in the data</a></li>
<li><a class="nav-link" href="#reading-data-into-rstudio"><span class="header-section-number">6.2.3</span> Reading data into RStudio</a></li>
<li><a class="nav-link" href="#test-yourself"><span class="header-section-number">6.2.4</span> Test yourself</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#data-wrangling"><span class="header-section-number">6.3</span> Data wrangling</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#selecting-variables-for-our-analysis"><span class="header-section-number">6.3.1</span> "Selecting" variables for our analysis</a></li>
<li><a class="nav-link" href="#mutating-the-sample-id-variable"><span class="header-section-number">6.3.2</span> "Mutating" the Sample ID variable</a></li>
<li><a class="nav-link" href="#grouping-and-summarising-the-data"><span class="header-section-number">6.3.3</span> "Grouping" and "Summarising" the data</a></li>
<li><a class="nav-link" href="#recreating-the-figure"><span class="header-section-number">6.3.4</span> Recreating the figure</a></li>
</ul>
</li>
<li><a class="nav-link" href="#test-yourself-exercise"><span class="header-section-number">6.4</span> Test yourself exercise</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>NS7154 R Workbook</strong>" was written by Dr Richard Clarke. It was last built on 2023-08-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
