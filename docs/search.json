[{"path":"index.html","id":"index","chapter":"1 Index","heading":"1 Index","text":"","code":""},{"path":"welcome.html","id":"welcome","chapter":"2 Welcome","heading":"2 Welcome","text":"Welcome R Lab Book NS7514 Health Context: Cell SocietyOver course semester book guide use R RStudio organise, visulise, analyse health data related lecture content week module. book take absolute basics R, point able make stunning visulisations, expert analysis , importantly, conduct analysis assignment.","code":""},{"path":"welcome.html","id":"why-learn-r-why-not-just-use-spss-or-stata","chapter":"2 Welcome","heading":"2.1 Why learn R? Why not just use SPSS or STATA?","text":"completed undergraduate psychology degree good chance taught statistical analysis using SPSS STATA. programs great, capable conducting amazing analysis, data real world often lot messier data saw undergraduate degree. want leave MSc skills needed deal messiness, wherever may end , R excellent place hone skills.Need convincing? usual go-reasons learning R psychology student.1. R open access therefore freeSPSS STATA ludicrously expensive. personal licence, last check, cost little $1000 per year. fine university cover (now), move away academia perhaps charity non-government organisation cost many willing pay ., may find many jobs perfectly capable , knowledge point view, just access tools trained .position finished last post-doc. Doors closed - really interesting door done lot good - due skill base narrow applicable . want case . end course able analysis can already paid software, free accessible language quickly becoming highly desirable skill graduate .2. Data wranglingSay want conduct longitudinal research. find participants, send surveys month, also perhaps visit person take bio-physiological measurements (blood pressure, BMI etc). data recorded saved across multiple different excel files. participants drop fail respond time points. match participants final dataset combine files format able run analysis?problem rarely cover undergraduate, common essential part research process, especially health data collected third party (.e. charity even NHS). days learnt R kind problem led copy pasting chunks data excel, entering data SPSS hand, number long laborious processes prone silly mistakes lapses concentration poor work processes.skill cope data problem described , many others, know data wrangling skill best deployed code. end module, able raw data project together folder, open script written, click run end perfect dataset ready analysis every time.3. Data visulisationsI never truly understand data can see . Relationships variables, differences groups, location data, can visulised quickly effectively using R. may favorites creating across course semester:add visulisations hereAnd great thing creating code next time come across similar data format can simply copy previous code adapt needs. clicking around excel trying find colours arrangement last time, ugly SPSS outputs, just publication ready figures communicate amazing finds way words just capture.4. ReproducabilityIf psychology may heard \"Replication Crisis\". Findings previously held reliable understandings human condition crumbling dust apply rigor scientific method., now infamous, 2015 study Open Science Collaboration followed methodology 100 experimental reports, single year (2008), published range high-ranking journals. aim see many findings replicated (.e. repeated produced results). 100 39 found successful replicate.finding proved watershed moment psychology whereby many questioning reliability work.One solution suggested make process science far transparent, R comes . means solves issues replication crists submitting code along making data open access, readers work longer need \"take word \" conducted appropriate analysis correctly reported results. can now check .Journal also starting take note culture shift starting require submission analysis reports. luck skill start align getting published.talk much aspect get section Rmarkdown reproducability workflows.Hopefully convinced importance learning R psychology student. link particularly good talk Phil McAleer University Glasgow moved undergraduate degree towards focus reproducible research, using R statistics.Now learning!","code":""},{"path":"getting-started.html","id":"getting-started","chapter":"3 Getting started","heading":"3 Getting started","text":"","code":""},{"path":"getting-started.html","id":"installing-r-and-rstudio","chapter":"3 Getting started","heading":"3.1 Installing R and RStudio","text":"R programming language ’ll learning write code , RStudio know Integrated Development Environment (IDE) makes working R easier. largely use terms \"R\" \"RStudio\" interchangeable throughout course, can think writing R writing English RStudio program write . write written assignment NotePad Microsoft Word gives lot freedom ’s often default. logic true R, using RStudio just makes life lot easier.\nget started first need install language R IDE RStudio. can installed, free, company maintains , Posit. need select operating system (Windows Mac).One best things using R RStudio widely used across many academic disciplines, professional world. many guides installation. hit issue installation, likely . helpful links help install R RStudio home computer (highly recommend ):University Glasgow PsyTeachR installation guideYouTube video showing download process WindowsYouTube video showing download process Mac","code":""},{"path":"getting-started.html","id":"opening-rstudio-for-the-first-time","chapter":"3 Getting started","heading":"3.2 Opening RStudio for the first time","text":"first open RStudio greeted page looks like :double check RStudio opening just R text editor.First thing suggest click File -> New File -> R Script. show normal view get working R.\nfour segments screen:console (Bottom left) - directly running short snippets code, also output errors (sooo many errors) shown.script editor (Top left) - writing longer chunks code able save file.area shows functions objects create (Top right).area shows fancy figures create, also somewhere can navigate files (Bottom right).’ll become intimately aware areas course module want overview sections now video give good introduction section (recommend watching around 5mins 45sec).Finally basic set , important look cool analysis R. change basic appearance:Click Tools -> Global Options -> Appearance.like Editor Theme Vibrant Ink. makes feel like hacker 90's. Also, old like may want make use View -> Zoom option.Stressed yet? worry, screen looking like time. learning curve R things start click love !","code":""},{"path":"getting-started.html","id":"packages","chapter":"3 Getting started","heading":"3.3 Packages","text":"basic functions R great, one useful things working R (instead commercial software) ability incorporate user generated content customise able . add-content known packages. validated frequently used packages stored CRAN (Comprehensive R Archive Network) server RStudio knows exactly find , long know name package. need click around random websites downloading files install, nice.module make extensive use tidyverse package. package brings together set grammar visulisation tools makes process writing R whole lot easier.\ninstall tidyverse package type following code console (next bottom >) hit enter key run code. can copy paste directly document clicking clipboard icon top right box.ever need install package per computer need load time open RStudio. subsequent times code need:analysis write good idea include packages first code script, copy code place top new script (top left screen, created one).run , code, can either highlight code click Run button top right script window. can navagate line want run hit Ctrl+Enter.","code":"\ninstall.packages(\"tidyverse\")\nlibrary(tidyverse)"},{"path":"writing-and-running-your-first-code.html","id":"writing-and-running-your-first-code","chapter":"4 Writing and running your first code","heading":"4 Writing and running your first code","text":"Okay, lets get coding!","code":""},{"path":"writing-and-running-your-first-code.html","id":"r-as-an-overpowered-calculator","chapter":"4 Writing and running your first code","heading":"4.1 R as an overpowered calculator","text":"Firstly, R excellent calculator. Take following lines code try running console script window.run code console (bottom left window RStudio) click bottom \">\" symbol, type paste code like run, hit Enter key.run code script window:Make sure script window open, can open new script clicking File -> New File -> R Script.Make sure script window open, can open new script clicking File -> New File -> R Script.Type paste code want run.Type paste code want run.Highlight code click Run navigate line/chunk like run hit Ctrl+Enter (mac Command+Enter)Highlight code click Run navigate line/chunk like run hit Ctrl+Enter (mac Command+Enter)running line code output reported console look something like :[1] beginning output way indexing output. Take following code instance:rnorm(50, 5, 1)Running generates set 50 data points normally distributed mean 5 standard deviation 1. creates long output spans multiple lines number [] gives indication many data points displayed line.final line code ran used function, case sqrt function used order perform square root calculation. typing RStudio may noticed typing first three letters box popped rest function. hover box mouse see explanation function.super helpful feature RStudio end using lot. {base} indicates function exists within base version R. Later using functions added tidyverse package. worth keeping eye common error trying use function package loaded.Another way learn function running: ?sqrt. loads help file bottom right explains information function.Try running following functions dplyr package included tidyverse package:received error message reads somthing like :documentation ‘mutate’ specified packages libraries:\ntry ‘??mutate’likely due yet installed loaded tidyverse package. install simple run install.packages(\"tidyverse\") console script. Read previous chapter covers packages detail .help files likely confusing moment make lot sense go coding.","code":"\n1+1\n\n4*(14-4)\n\n10^2\n\nsqrt(144)## [1] 2## [1] 40## [1] 100## [1] 12\nlibrary(tidyverse)\n\n?mutate\n?select\n?arrange"},{"path":"writing-and-running-your-first-code.html","id":"this-is-a-smart-book","chapter":"4 Writing and running your first code","heading":"4.2 This is a \"smart book\"","text":"see blue boxes section ? using throughout book include additional explanation hide solutions exercises can first try work code . Also places include questions allow self-test knowledge. example:square root 36864 Use sqrt() functionThe box turn green input correct number.code use load help file rnorm function? ?rnormIs using AI permitted module? Absolutely , dare !Yes, fact encouraged!","code":""},{"path":"writing-and-running-your-first-code.html","id":"meet-your-pesonal-r-tutor-chatgpt-or-alternitive","chapter":"4 Writing and running your first code","heading":"4.3 Meet your pesonal R tutor ChatGPT (or alternitive)","text":"Well good time introduce teaching assistant module, ChatGPT (equivalent alternative)Writing code become vastly easier last year public release various Large Language Models (LLMs) AIs. go depth LLMs work (mainly actually know) basic terms LLM artificial intelligence \"trained\" unfathomablly large amount language data across internet. previously mentioned, many academic disciplines businesses use R data analyses many guides resources online explaining write code R. Talking LLM like talking someone read, memorised, understands guides able explain pretty much simple understand way.Personally, use LLM called ChatGPT OpenAI, can set free account just email address. paid version, need using semester. Lately, working AI two write apps teaching undergraduate statistics (like ) say makes learning new aspects coding far quicker enjoyable hacking way Google YouTube looking suitable explanations.chatbot thought nice let ChatGPT introduce , click link see transcript conversation demonstration working AI can R learning.\nSeeing just entered brave new world Ai, now, ask use LLMs aid R coding rather written work (doubt heard hugely disruptive ability write essays). stage please use module, lecturers may different preferences like respect. doubt, ask.","code":""},{"path":"writing-and-running-your-first-code.html","id":"back-to-the-coding","chapter":"4 Writing and running your first code","heading":"4.4 Back to the coding","text":"using R basic calculate basically using sledgehammer crack walnut. Obviously coding R can much . One really important aspect R assigning data object.","code":""},{"path":"writing-and-running-your-first-code.html","id":"assigning-numbers-to-objects","chapter":"4 Writing and running your first code","heading":"4.4.1 Assigning numbers to objects","text":"Run following code line line. time run line take look environment tab top right window RStudio.first two lines use <- symbols assign number letter. third line adds value value b creates new object c containing value sum +b. fourth line add three created objects together, look console see output sum.\nfirst instinct likely say ball costs £0.10 answer actually £0.05. can check just learnt assigning values objects. See can adapt code appropriately test test . Reassigning value object overrides previous value, can click little broom icon environment window remove previous objects.worry question still hurts brain, even teaching years!Bat + Ball = 1.10Bat = 1.00 + Ball1.00 + 2*Ball = 1.10Ball = (1.10 - 1.00)/2Ball = 0.1 / 2Ball = 0.05","code":"\na <- 5\nb <- 10\n\nc <- a+b\n\na+b+c## [1] 30\n# change out the question mark until you get the correct answer of 1.1\n\nBall <- ?\n\nBat <- Ball + 1.00\n\nBat + Ball "},{"path":"writing-and-running-your-first-code.html","id":"assigning-multiple-data-to-an-object","chapter":"4 Writing and running your first code","heading":"4.4.2 Assigning multiple data to an object","text":"object can hold just single value. following code range numerical data created, assigned object age. c() function concatenates (fancy word links) values together <- stores single object, case age.assigning data age run age (either console script) list appear output console.Sometimes data want just list consecutive numbers. following lines code equivalent however one substantially quicker , especially scale.can also assign words/letters (known string data) object.might see going , yes can combine objects data set assign yet another object. can see created new type object environment window, Data object. tells us many observations (case, rows data) many variables (case, columns data). can now view data clicking using view() command.","code":"\nage <- c(23, 57, 42, 12, 8, 92, 35, 86, 26, 65)\nID_number <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)\n\nID_number <- 1:10\nnames <- c(\"Kayleigh\", \"Lisa\", \"Beatrice\", \"Jessie\", \"Hugo\", \"Justin\", \"Mohammed\", \"Shawn\", \"Hasan\", \"Kelly\")\n\ngender <- c(\"Female\", \"Female\", \"Female\", \"Female\", \"Male\", \"Male\", \"Male\", \"Male\", \"Male\", \"Non-binary\")\ndata <- data.frame(ID_number, age, names, gender)\n\nview(data)"},{"path":"writing-and-running-your-first-code.html","id":"extra-exercises","chapter":"4 Writing and running your first code","heading":"4.5 Extra exercises","text":"Create dataframe contains data following table:way , achieved results different way. Great, well done!Next use rnorm function generate data participant. Feel free chose mean standard deviation.R case sensitive double check capatalisation objects throughout.forget can use ?rnorm command open help file rnorm function. show use ., way , achieved results different way. Great, well done!Also technically random data data adhears normal distrabution.Loving learning R want ? Rather raceing ahead book suggest taking look guides . PsyTeachR particularly good (learnt), R data science classic. also love TidyTuesday community suggest learning basics diving datasets.","code":"\nAge <- c(18, 18, 19, 22, 24, 24, 25, 29, 35, 42, 52, 68)\n\nID <- 1:12\n\nGender <- c(\"Female\", \"Female\", \"Male\", \"Female\", \"Male\",\"Female\",\"Non-binary\", \"Male\", \"Male\", \"Male\", \"Female\",\"Non-binary\")\n\nScore <- c(100, 89, 92, 62, 100, 75, 78, 89, 100, 86, 68, 85) \n\ntestscore <- data.frame(ID, Age, Gender, Score)\nRandom <- rnorm(12, 2, 1)\n\ntestscore <- data.frame(ID, Age, Gender, Score, Random)"},{"path":"week-2---basic-visualisation.html","id":"week-2---basic-visualisation","chapter":"5 Week 2 - Basic visualisation","heading":"5 Week 2 - Basic visualisation","text":"","code":""},{"path":"week-2---basic-visualisation.html","id":"introduction","chapter":"5 Week 2 - Basic visualisation","heading":"5.1 Introduction","text":"chapter, want introduce data visualisation package ggplot2 (contained within tidyverse). ggplot incredibly versatile way creating graphs become standard throughout academic publishing data journalism.link post BBC talking recently moved using ggplot data visualisationsSoon spotting figures everywhere start saying \"bet recreate ggplot\", get sad find share data :-(following examples exercises, using 2015 country-level summary World Health Organisation data related life expectancy (source). next chapter, show upload data files now given code imports dataset directly GitHub (web hosting system use book).chapter need following packages:Remember using packages first time need run install.packages(\"packagename\"). often best run console just re-installing package time run code.Note quotation marks around package name. R quite sensitive sort precision , , attention detail ends solving errors get. Either just ask ChatGPT . completely legitimate ways code!worked way previous chapters, already tidyverse installed likely need install ggrepel.","code":"\n# Run this code to get the data for this chapter\nlibrary(tidyverse)\n\nwho_rawdata <- read_csv(\"https://raw.githubusercontent.com/RichClarkePsy/Datasets/main/Life%20expectancy%20dataset.csv\") \nlibrary(tidyverse) # contains the ggplot2 package\nlibrary(ggrepel) # used for add text labels to data points"},{"path":"week-2---basic-visualisation.html","id":"getting-stuck-and-overwhelmed","chapter":"5 Week 2 - Basic visualisation","heading":"5.1.1 Getting stuck and overwhelmed?","text":"Throughout week going chucks code little clue going . ok! One best ways learn R just play around pre-existing, change parts see happens. run errors understand, code want explained, just copy past ChatGPT conversation explain (included example later). can even ask follow questions ask adapt code specifications. Though help know least little code , especially later course move analysis.","code":""},{"path":"week-2---basic-visualisation.html","id":"getting-an-overview-of-your-data","chapter":"5 Week 2 - Basic visualisation","heading":"5.2 Getting an overview of your data","text":"point packages loaded data file top right Environment window named who_rawdata. Just looking data window can see two aspects dataset; number observations number variables. Observations case individual countries variables going various health social data.Click dataset run view(who_rawdata) take look data. new tab appear view similar :Viewing data like good quick look data, however, health often using datasets many hundreds variables thousands observations. looing data directly much might using SPSS. Instead want get habit exploring dataset code.following gives basics information dataset:viewing output code...variable name life expectancy? Name variable string/character data average number years schooling across countries? ","code":"\ndim(who_rawdata)\n\nstr(who_rawdata)\n\nsummary(who_rawdata)"},{"path":"week-2---basic-visualisation.html","id":"visualising-global-life-expectancy","chapter":"5 Week 2 - Basic visualisation","heading":"5.3 Visualising global life expectancy","text":"Statistics great (done undergraduate know love !), often, want get quick easy understanding dataset, can get everything want simple data visualisation.","code":""},{"path":"week-2---basic-visualisation.html","id":"histograms","chapter":"5 Week 2 - Basic visualisation","heading":"5.3.1 Histograms","text":"Histograms good first step towards understanding continuous variable like life expectancy. create histogram going take dataset going pipe %>% ggplot function.pipe basically way saying \"\" code helps tidy things creating object object. case saying: take data use data following ggplot expression.can done one line lot neater hit enter pipe start next expression next line. also indents ease navigation. part grammar coding 'll get use time.\nPsyTeachR great chapter pipes explains concept depth. now can just adapt code given .see code pipes like %>% module |> also job. difference far nerdy us care , just know basically thing.ggplot visulisation made layers. start mapping aesthetic (aes), involves organisation data goes axis data segmented within visualisation. layer (using + sign) geometry combine data desired visual format. following example places life expectancy x-axis uses histogram geometry.fine quick exploration data also tidy point perfectly fine include paper.","code":"\nwho_rawdata %>%\n  ggplot(aes(x=Life_exp)) +\n  geom_histogram()\nwho_rawdata %>%\n  ggplot(aes(x=Life_exp)) +\n  geom_histogram(binwidth = 1, \n                 colour = \"black\", \n                 fill = \"#58A139\") +\n  labs(title = \"Figure 1. Histogram of Global Life Expectancy\",\n       subtitle = \"N = 183 countries\",\n       x = \"Life expectancy from birth\",\n       y = \"Number of countries\",\n       caption = \"Year: 2015 | Data source: WHO\") +\n  theme_light() +\n  theme(plot.caption = element_text(hjust = 0.5))"},{"path":"week-2---basic-visualisation.html","id":"exercise-1","chapter":"5 Week 2 - Basic visualisation","heading":"5.3.2 Exercise 1","text":"Take code adapt work arguments (e.g. \"binwidth\" \"subtitle\") control. Colours can words hex codes. useful website can get hex codes www.htmlcolorcodes.com.point Googled pretty much every element .Try searching following see can find similar looking code:\"Change colour histogram bars ggplot\"\"Add caption ggplot figure\"\"Align caption center ggplot\"Also conversation ChatGPT makes changes final version suggests genuinely helpful additions (dotted gridlines nice touch).","code":""},{"path":"week-2---basic-visualisation.html","id":"facet-wrap","chapter":"5 Week 2 - Basic visualisation","heading":"5.3.3 Facet wrap","text":"good starting visualisation, say want understand distribution region. need add last line code create nicely formatted version six histograms together.~ often used R denote relationship. often see regression analysis case telling ggplot facet (.e. seperate) graph Continent","code":"\nwho_rawdata %>%\n  ggplot(aes(x=Life_exp)) +\n  geom_histogram(binwidth = 1, \n                 colour = \"black\", \n                 fill = \"#58A139\") +\n  labs(title = \"Figure 1. Histogram of Global Life Expectancy\",\n       subtitle = \"N = 183 countries\",\n       x = \"Life expectancy from birth\",\n       y = \"Number of countries\",\n       caption = \"Year: 2015 | Data source: WHO\") +\n  theme_light() +\n  theme(plot.caption = element_text(hjust = 0.5)) +\n  facet_wrap(~ Continent)"},{"path":"week-2---basic-visualisation.html","id":"boxplots","chapter":"5 Week 2 - Basic visualisation","heading":"5.3.4 Boxplots","text":"histograms definitely value (instance can now see difference life expectancy Europe Africa clearly), better way visualise data might change histogram boxplot.Much better, instantly can see distribution life expectancy differs across continents. things spring mind make figure informative.Label outliers ('d nice know countries )Add colourAdd title etcThe first point genuinely quite hard solve involves two lines code .first line creates new function can used identify outliers variable. , next line, uses function make new variables ever time function finds outlier Life_exp assigns text Country variable.Also, made change data (case added new variable) assigned (<-) new object name always try keep raw data form read . Just case need use later. Notice new dataframe object environment window running .add outlines figure added layer text box plot layer.two points selected pre-existing colour pallet mapped Continent variable added labels labs function.Now good looking figure!lot going make figures luckily need keep head one time. often go back old code code webbooks like PsyTeachR adapt change needs.fact lets adapt code BMI insterad life expectancy","code":"\nwho_rawdata %>%\n  ggplot(aes(x=Life_exp, y=Continent)) +\n  geom_boxplot() +\n  theme_light()\nfindoutlier <- function(x) {\n  return(x < quantile(x, .25) - 1.5*IQR(x) | x > quantile(x, .75) + 1.5*IQR(x))\n  }   \n\nwho_with_outliers <- who_rawdata %>% \n  group_by(Continent) %>%\n  mutate(outlier_LE = ifelse(findoutlier(Life_exp), Country, NA)) \nwho_with_outliers %>%\n  ggplot(aes(x=Life_exp, y=Continent, fill = Continent)) +\n  geom_boxplot(width = 0.5,\n               alpha = 0.75,\n               show.legend = FALSE) +\n  geom_text_repel(aes(label=outlier_LE),\n                  position = \"identity\",\n                  size = 3,\n                  na.rm=TRUE) +\n  scale_fill_brewer(palette = \"Dark2\") +\n  labs(title = \"Figure 2. Boxplot of Global Life Expectancy\",\n       subtitle = \"N = 183 countries\",\n       x = \"Life expectancy from birth\",\n       y = \"\",\n       caption = \"Year: 2015 | Data source: WHO\") +\n  theme_light() +\n  theme(plot.caption = element_text(hjust = 0))"},{"path":"week-2---basic-visualisation.html","id":"exercise-2","chapter":"5 Week 2 - Basic visualisation","heading":"5.3.5 Exercise 2","text":"Adapt code make histogram boxplot BMI variable instead life expectancy.Note: code calculating outliers BMI, requires adding extra line drop_na(BMI). tells R remove missing data variable BMI. Note change dataset name well.hide(hint)running code need start data_BMI file rather rawdata.Look see parts code say Life_exp change BMIMake sure remember change title axis lables.unhide()hide(Solution)one way histogram coul look:one way box plot look:unhide()notice data visual check?Personally, concerned low BMI data points, BMI never really low. Perhaps data recording issue. way know without raw data go . analysis may want filter data points, least check data sources.","code":"\nwho_BMI %>%\n  ggplot(aes(x=BMI)) +\n  geom_histogram(binwidth = 1, \n                 colour = \"black\", \n                 fill = \"#58A139\") +\n  labs(title = \"Figure 1. Histogram of Body Mass Index\",\n       subtitle = \"N = 183 countries\",\n       x = \"BMI\",\n       y = \"Number of countries\",\n       caption = \"Year: 2015 | Data source: WHO\") +\n  theme_light() +\n  theme(plot.caption = element_text(hjust = 0.5))\nwho_BMI %>%\n  ggplot(aes(x=BMI, y=Continent, fill = Continent)) +\n  geom_boxplot(width = 0.5,\n               alpha = 0.75,\n               show.legend = FALSE) +\n  geom_text_repel(aes(label=outlier_BMI),\n                  position = \"identity\",\n                  size = 3,\n                  na.rm=TRUE) +\n  scale_fill_brewer(palette = \"Dark2\") +\n  labs(title = \"Figure 3. Boxplot of global BMI\",\n       subtitle = \"N = 181 countries\",\n       x = \"BMI\",\n       y = \"\",\n       caption = \"Year: 2015 | Data source: WHO\") +\n  theme_light() +\n  theme(plot.caption = element_text(hjust = 0))## Warning: ggrepel: 3 unlabeled data points (too many overlaps). Consider\n## increasing max.overlaps"},{"path":"week-2---basic-visualisation.html","id":"correlation-between-variables","chapter":"5 Week 2 - Basic visualisation","heading":"5.4 Correlation between variables","text":"Next lets take look good ggplot making scatter plots. following code plots number years schooling (x-axis) life expectancy (y=axis) 183 countries., takes dataset pipes ggplot. aestectic years schooling x axis life expectancy y axis. geometry layer using geom_point (rather geom_boxplot geom_histogram) creates scatter plot.clear correlation. comming chapters look strong correlation , now, tidy , can add regression line (adding extra geometry layer geom_smooth) titles.happens change order put geom_smooth geom_point function? dots visableOnly line visableThe dots now appear ontop lineEverything brakes!usually multiple different ways achieve using ggplot. Can delete bottom two lines code find way label x y axis within labs function?Check code earlier\nunhide()bit freedom can aestetic scatter plot. can map colour data points using Continent variable dataset.can even map size points Population variable larger population larger dot.comments code also indicate parts AI assistants. remember make changes top head. Googleing taken 15 mins find right guide right code requests ChatGPT took less minute also gave explanation extra code works.","code":"\nwho_rawdata %>%\n  ggplot(aes(x = Schooling, y = Life_exp)) +\n  geom_point()\nwho_rawdata %>%\n  ggplot(aes(x = Schooling, y = Life_exp)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              formula = y ~ x) +\n  labs(title = \"Figure 2. A scatter plot of life expectancy by number of years of schooling\",) +\n  xlab(label = \"Average number of years of schooling\")+\n  ylab(label = \"Average life expectancy (in years)\")\nwho_rawdata %>%\n  ggplot(aes(x = Schooling, y = Life_exp)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              formula = y ~ x) +\n  labs(title = \"Figure 2. A scatter plot of life expectancy by number of years of schooling\",\n       x = \"Average number of years of schooling\",\n       y = \"Average life expectancy (in years)\") ## Warning: Removed 10 rows containing non-finite values (stat_smooth).## Warning: Removed 10 rows containing missing values (geom_point).\nwho_rawdata %>%\n  ggplot(aes(x = Schooling, y = Life_exp, colour = Continent)) +\n  geom_point() +\n  geom_smooth(aes(group = 1), method = \"lm\", \n              formula = y ~ x, colour = \"black\") +\n  labs(title = \"Figure 3. A scatter plot of life expectancy by number of years of schooling\",\n       x = \"Average number of years of schooling\",\n       y = \"Average life expectancy (in years)\") # delete aes(group = 1) & ,colour = \"black\" to see why I included them\nwho_rawdata %>%\n  ggplot(aes(x = Schooling, y = Life_exp, colour = Continent, size = Population)) +\n  geom_point() +\n  geom_smooth(aes(group = 1), method = \"lm\", formula = y ~ x, colour = \"black\") +\n  labs(title = \"Figure 3. A scatter plot of life expectancy by number of years of schooling\",\n       x = \"Average number of years of schooling\",\n       y = \"Average life expectancy (in years)\") +\n  guides(size = FALSE) # delete this line to see why I included it "},{"path":"week-2---basic-visualisation.html","id":"adding-to-the-aestetic","chapter":"5 Week 2 - Basic visualisation","heading":"5.4.1 Adding to the aestetic","text":"bit freedom can aestetic scatter plot. can map colour data points using Continent variable dataset.can even map size points Population variable larger population larger dot.comments code also indicate parts AI assistants. remember make changes top head. Googleing taken 15 mins find right guide right code requests ChatGPT took less minute also gave explanation extra code works.","code":"\nwho_rawdata %>%\n  ggplot(aes(x = Schooling, y = Life_exp, colour = Continent)) +\n  geom_point() +\n  geom_smooth(aes(group = 1), method = \"lm\", \n              formula = y ~ x, colour = \"black\") +\n  labs(title = \"Figure 3. A scatter plot of life expectancy by number of years of schooling\",\n       x = \"Average number of years of schooling\",\n       y = \"Average life expectancy (in years)\") # delete aes(group = 1) & ,colour = \"black\" to see why I included them\nwho_rawdata %>%\n  ggplot(aes(x = Schooling, y = Life_exp, colour = Continent, size = Population)) +\n  geom_point() +\n  geom_smooth(aes(group = 1), method = \"lm\", formula = y ~ x, colour = \"black\") +\n  labs(title = \"Figure 3. A scatter plot of life expectancy by number of years of schooling\",\n       x = \"Average number of years of schooling\",\n       y = \"Average life expectancy (in years)\") +\n  guides(size = FALSE) # delete this line to see why I included it "},{"path":"week-2---basic-visualisation.html","id":"exercise-3---applying-what-you-have-learnt","chapter":"5 Week 2 - Basic visualisation","heading":"5.5 Exercise 3 - Applying what you have learnt","text":"Gapminder organisation one non-profits. mission promote fact-based worldview everyone can understand. Never seen data demography global helath issues communicated engaging way. instance,best 5 minutes data communication ever seen. Sadly lost Hans Rosling 2017 son daughter--law continue amazing work worth following.Gapminder also R package contains data similar data just using. Install package, load package, import data using code .looking data can likely see lot time. due also year variable can see changes time. code just extracts data recent year data set, 2007.Created histograms life expectancy GDPCreated boxplots life expectancy GDPCreate simple scatter plot life expectancy GDPAdd continent population size data scatter plot 3Make sure appropriate title axis.","code":"\ninstall.packages(\"gapminder\")\n\nlibrary(gapminder)\n\ngapminder_data <- gapminder::gapminder\ngapminder_2007 <- gapminder_data %>%\n  filter(year == 2007)"},{"path":"week-3---working-with-data-files.html","id":"week-3---working-with-data-files","chapter":"6 Week 3 - Working with data files","heading":"6 Week 3 - Working with data files","text":"","code":""},{"path":"week-3---working-with-data-files.html","id":"introduction-1","chapter":"6 Week 3 - Working with data files","heading":"6.1 Introduction","text":"aim chapter reproduce following figure Bravo-Gutierrez et al (2021). figure shows percentage methylation two genes, AHRR (fig. 2a) PRSS23 (fig. 2b), compared across smokers non-smokers. genetics aspect might confusing (least us psychologists) statistics basics (Mann-Whitney U test). authors found significant difference across smokers AHRR gene (p=0.003) across PRSS23 gene (p=0.276)authors paper made data study open access (good scientists !), code. replicate analysis see can find results can create image.Download data papers supplemental materials bottom paper access moodle uploaded file weeks section.chapter need following packages. needed, check previous chapters install load packages.","code":"\nlibrary(tidyverse) # tidy grammer and ggplot for the graphs\nlibrary(broom) # tidys up and statistical findings\nlibrary(ggpubr) # to add p values to graph"},{"path":"week-3---working-with-data-files.html","id":"reading-data-into-r-from-a-data-file","chapter":"6 Week 3 - Working with data files","heading":"6.2 Reading data into R from a data file","text":"Data often messy, especially true data collect , especially especially true data academics share online. Data transparency often afterthought publication, little care attention given data usable, mostly just shared order tick box say available.Thankfully, data shared paper nice neat tidy, need take steps get R.","code":""},{"path":"week-3---working-with-data-files.html","id":"setting-your-working-directory","chapter":"6 Week 3 - Working with data files","heading":"6.2.1 Setting your working directory","text":"time start analysis R recommend create new folder. Put data want analyses folder. Open script R save script newly created folder along data.everything place, back RStudio, set working directory clicking Session -> Set Working Directory -> Choose Directory select chosen folder.allows R know look want import data, also save outputs. seems like silly step just making couple plots, projects become complicated kind workflow becomes invaluable.","code":""},{"path":"week-3---working-with-data-files.html","id":"file-formats-and-reading-in-the-data","chapter":"6 Week 3 - Working with data files","heading":"6.2.2 File formats and reading in the data","text":"Open Excel file downloaded supplemental materials Bravo-Gutierrez et al 2021. see four tabs bottom file, means going split file individual pages get RStudio. Excel files also comes whole load hidden junk want instead like save tab Comma-Separated Values (CSV) file, just text file comma separating values data set.data tab S4 luckily lovely state just requires us navigate S4 tab, click save select CSV drop \"save type\" menu. Save folder created previously.continuing, take quick look tabs file. Tab one looks intimidating just two screen shots online gene database. tabs S2 S3 scare (least take get usable form). scroll either tabs see headers repeat data neatly line find SPSS file. Carry R learn work , even messier, kind data, turn whats known tidy data.","code":""},{"path":"week-3---working-with-data-files.html","id":"reading-data-in-to-r","chapter":"6 Week 3 - Working with data files","heading":"6.2.3 Reading data in to R","text":"long set working directory loaded tidyverse package following code, adapted file name, read data assign object.read.csv base R, read_csv function found readr package tidyverse extra step get function worth three reasons:read_csv convert character strings factors default, unlike read.csv.read_csv returns tibbles rather data frames. Basically, tibbles work better tidyverse packagesread_csv something NAs.dullest note topic whole book? Maybe, good contender least.","code":"\nraw_data <- read_csv(\"Bravo-Gutierrez figure 2 data.csv\")"},{"path":"week-3---working-with-data-files.html","id":"self-test","chapter":"6 Week 3 - Working with data files","heading":"6.2.4 Self test","text":"working directory ? location computer RStudio runs accesses filesIt give extra RAM analysis quickerIt changes colour theme RStudioWhat CSV file? file specially made use RA general use text file storing tabular data, separated commasA file storing supplementary figure paperWhat type read following data assign object data?Can read SPSS file R? program dead us now. Never speak letter !Yes, check Haven package topic","code":""},{"path":"week-3---working-with-data-files.html","id":"step-2-data-wrangling","chapter":"6 Week 3 - Working with data files","heading":"6.3 Step 2: Data wrangling","text":"yet wrangle. Well, wrangled little last chapter really explainWe actually need three variables dataset first thing going tidy data set pull variables put new object called fig2_data.Use select function (mentioned week 1) take variables Sample_ID, %5mc-AHRR & %5mc-PRSS23 create new object called fig2_dataIf look Sample_ID variable, see variable indicates participant non-smoker (NS) smoker (S) includes ID number. order recreate analysis need create new variable just contains smoker non-smoker data.number ways , :first line tells R just overwrite data object whatever next. used mutate function create new variable. variable called smoker told R look start string data variable Sample_ID letters \"NS\" first put \"Non-Smoker\" new variable, letter \"S\" first put \"Smoker\" new variable.View(fig2_data) now see new variables created smoker/non-smoker information.Lets also change names gene variables :Variable names need specific format R recognise . original data starts % sign confuses R. get around issue encloses name `` punctuation, way indicate string. commonly see variable name SPACE words. worth recording see can bit pain comes using auto-complete analysis later .","code":"\nfig2_data <- raw_data %>%\n  select(Sample_ID, `%5mc-AHRR`,`%5mc-PRSS23`)\nfig2_data <- fig2_data %>%\n  mutate(smoker = case_when(str_starts(Sample_ID, \"NS\") ~ \"Non-Smoker\",\n                            str_starts(Sample_ID, \"S\") ~ \"Smoker\")) \nfig2_data <- fig2_data %>%\n  rename(AHRR = `%5mc-AHRR`,\n         PRSS23 = `%5mc-PRSS23`)"},{"path":"week-3---working-with-data-files.html","id":"step-3-discriptive-statistics-and-basic-visulisation","chapter":"6 Week 3 - Working with data files","heading":"6.4 Step 3: Discriptive statistics and basic visulisation","text":"Now run basic summary statistics get feel data.Create new dataframe called fig2_discriptives fig2_data object. dataframe needs contain number partcipants mean, median, standard deviation AHRR methylation split smokers non-smokers.need use group_by summarise functions mentioned week 2. also missing data also need include following code various points na.rm = TRUENext use ggplot create basic box plot AHRR methylation variable separated smoker independent variable.","code":"\nfig2_discriptives <- fig2_data %>%\n  group_by(smoker) %>%\n  summarise(N = n(), \n            Mean = mean(AHRR, na.rm = TRUE), \n            Median = median(AHRR, na.rm = TRUE), \n            SD = sd(AHRR, na.rm = TRUE))\nfig2_data %>%\n  ggplot(aes(x=smoker, y=AHRR)) +\n  geom_boxplot()"},{"path":"week-3---working-with-data-files.html","id":"step-4-statistical-test","chapter":"6 Week 3 - Working with data files","heading":"6.5 Step 4: Statistical test","text":"Now statistical testcg05575921","code":"\ntest_result <- wilcox.test(AHRR ~ smoker, data=fig2_data) %>%\n  tidy() %>%\n  mutate(p.value = round(p.value, digits = 3))\nmy_comparisons <- list(c(\"Smoker\", \"Non-Smoker\"))\n\nfig2_data %>%\n  ggplot(aes(x=smoker, y=AHRR, fill=smoker)) +\n  geom_boxplot() +\n  scale_fill_brewer(palette=\"Dark2\") +\n  stat_compare_means(comparisons = my_comparisons) +\n  geom_jitter(width = .25) + \n  scale_y_continuous(name = \"%5mc-cg05575921\") +\n  theme(legend.position = \"none\")"},{"path":"week-3---working-with-data-files.html","id":"test-yourself-exercise","chapter":"6 Week 3 - Working with data files","heading":"6.6 Test yourself exercise","text":"Create new script create following PRSS23 geneA dataframe containing summary statisticsA dataframe containing comparison analysisFigure 2b original paper.Note create Figure 2b need additional line code re-scale y-axis:\nscale_y_continuous(limits=c(0, 10), name = \"PRSS23\")","code":"\n# reveal for answer\nfig2_discriptives <- fig2_data %>%\n  group_by(smoker) %>%\n  summarise(N = n(), \n            Mean = mean(PRSS23, na.rm = TRUE), \n            Median = median(PRSS23, na.rm = TRUE), \n            SD = sd(PRSS23, na.rm = TRUE))\n\n\nfig2_data %>%\n  ggplot(aes(x=smoker, y=PRSS23, fill=smoker)) +\n  geom_boxplot() +\n  scale_fill_brewer(palette=\"Dark2\") +\n  stat_compare_means(comparisons = my_comparisons, label.y = 10) +\n  geom_jitter(width = .25) + \n  scale_y_continuous(limits=c(0, 10), name = \"PRSS23\") + # limits added to make it look like the paper \n  theme(legend.position = \"none\")\n# more work needed to add the p values"}]
